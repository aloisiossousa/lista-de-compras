<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Simples - Formatação</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .result { background: #f0f0f0; padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <h1>Teste Simples de Formatação de Moeda</h1>
    <div id="results"></div>
    
    <script>
        // Função de formatação corrigida
        function formatCurrency(value) {
            if (value === null || value === undefined || value === '') {
                return 'R$ 0,00';
            }
            
            const numValue = parseFloat(value);
            if (isNaN(numValue) || !isFinite(numValue)) {
                return 'R$ 0,00';
            }
            
            try {
                return new Intl.NumberFormat('pt-BR', {
                    style: 'currency',
                    currency: 'BRL',
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                }).format(numValue);
            } catch (error) {
                return `R$ ${numValue.toFixed(2).replace('.', ',')}`;
            }
        }
        
        // Testes
        const tests = [
            { input: 0, expected: 'R$ 0,00' },
            { input: 1, expected: 'R$ 1,00' },
            { input: 1.5, expected: 'R$ 1,50' },
            { input: 10.99, expected: 'R$ 10,99' },
            { input: 123.45, expected: 'R$ 123,45' },
            { input: 1000, expected: 'R$ 1.000,00' },
            { input: '10.50', expected: 'R$ 10,50' },
            { input: 'abc', expected: 'R$ 0,00' },
            { input: null, expected: 'R$ 0,00' },
            { input: undefined, expected: 'R$ 0,00' }
        ];
        
        const results = document.getElementById('results');
        let passed = 0;
        
        tests.forEach(test => {
            const result = formatCurrency(test.input);
            const isCorrect = result === test.expected;
            
            if (isCorrect) passed++;
            
            const div = document.createElement('div');
            div.className = `result ${isCorrect ? 'success' : 'error'}`;
            div.innerHTML = `
                <strong>Input:</strong> ${JSON.stringify(test.input)} 
                <strong>Esperado:</strong> ${test.expected} 
                <strong>Resultado:</strong> ${result} 
                <strong>Status:</strong> ${isCorrect ? '✅' : '❌'}
            `;
            results.appendChild(div);
        });
        
        // Resultado final
        const finalDiv = document.createElement('div');
        finalDiv.className = `result ${passed === tests.length ? 'success' : 'error'}`;
        finalDiv.innerHTML = `<strong>Resultado Final:</strong> ${passed}/${tests.length} testes passaram (${Math.round(passed/tests.length*100)}%)`;
        results.appendChild(finalDiv);
    </script>
</body>
</html>
